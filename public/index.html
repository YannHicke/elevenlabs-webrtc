<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MedSimAI Patient Builder</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main>
      <h1>MedSimAI Patient Builder</h1>

      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab active" data-tab="create">Create Patient</button>
        <button class="tab" data-tab="existing">Use Existing</button>
      </div>

      <!-- Create Agent Tab -->
      <section id="create-tab" class="tab-content active">
        <h2>Create New Patient</h2>
        <form id="agent-form">
          <div class="form-group">
            <label for="agent-name">Patient Name</label>
            <input type="text" id="agent-name" placeholder="My Custom Patient" />
          </div>

          <div class="form-group">
            <label for="agent-prompt">Patient History *</label>
            <textarea id="agent-prompt" rows="6" placeholder="Patient history, medical history, medications, allergies, etc."></textarea>
          </div>

          <div class="form-group">
            <label for="first-message">Patient Goals (optional)</label>
            <input type="text" id="first-message" placeholder="Hello Doctor, What do you want?" />
          </div>

          <div class="form-group">
            <label for="voice-select">Voice</label>
            <div class="voice-select-wrapper">
              <select id="voice-select">
                <option value="">Loading voices...</option>
              </select>
              <button type="button" class="btn-preview" id="preview-voice-btn" title="Preview voice">
                ‚ñ∂
              </button>
              <button type="button" class="btn-browse" id="browse-voices-btn" title="Browse Voice Library">
                üîç
              </button>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="language-select">Language</label>
              <select id="language-select">
                <option value="en">English</option>
                <option value="es">Spanish</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="it">Italian</option>
                <option value="pt">Portuguese</option>
                <option value="pl">Polish</option>
                <option value="hi">Hindi</option>
                <option value="ja">Japanese</option>
                <option value="ko">Korean</option>
                <option value="zh">Chinese</option>
              </select>
            </div>
          </div>

          <button type="submit" id="create-agent-btn">Create Patient</button>
        </form>
      </section>

      <!-- Existing Agents Tab -->
      <section id="existing-tab" class="tab-content">
        <h2>Your Patients</h2>
        <div id="agents-list" class="agents-list">
          <p>Loading patients...</p>
        </div>
      </section>

      <!-- Voice Library Modal -->
      <div id="voice-library-modal" class="modal hidden">
        <div class="modal-content modal-large">
          <div class="modal-header">
            <h2>üé§ Voice Library</h2>
            <button class="modal-close" onclick="window.closeVoiceLibrary()">&times;</button>
          </div>
          <div class="voice-library-content">
            <div class="voice-search">
              <input type="text" id="voice-search-input" placeholder="Search voices (e.g., child, kid, boy, girl)..." />
              <select id="voice-language-filter">
                <option value="">All Languages</option>
                <option value="en">English</option>
                <option value="es">Spanish</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="it">Italian</option>
                <option value="pt">Portuguese</option>
                <option value="pl">Polish</option>
                <option value="hi">Hindi</option>
                <option value="ja">Japanese</option>
                <option value="ko">Korean</option>
                <option value="zh">Chinese</option>
                <option value="ar">Arabic</option>
                <option value="ru">Russian</option>
                <option value="nl">Dutch</option>
                <option value="sv">Swedish</option>
                <option value="tr">Turkish</option>
                <option value="id">Indonesian</option>
                <option value="fil">Filipino</option>
                <option value="vi">Vietnamese</option>
                <option value="th">Thai</option>
              </select>
              <select id="voice-gender-filter">
                <option value="">All Genders</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
                <option value="neutral">Neutral</option>
              </select>
              <button type="button" id="voice-search-btn">Search</button>
            </div>
            <div class="voice-suggestions">
              Quick: 
              <button type="button" class="chip" data-search="child">Child</button>
              <button type="button" class="chip" data-search="kid">Kid</button>
              <button type="button" class="chip" data-search="boy">Boy</button>
              <button type="button" class="chip" data-search="girl">Girl</button>
              <button type="button" class="chip" data-search="teen">Teen</button>
              <button type="button" class="chip" data-search="young">Young</button>
            </div>
            <div id="voice-library-results" class="voice-library-results">
              <p>Search for voices above to browse the library.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Agent Modal -->
      <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Edit Patient</h2>
            <button class="modal-close" onclick="window.closeEditModal()">&times;</button>
          </div>
          <form id="edit-form">
            <input type="hidden" id="edit-agent-id" />
            
            <div class="form-group">
              <label for="edit-agent-name">Patient Name</label>
              <input type="text" id="edit-agent-name" placeholder="My Custom Agent" />
            </div>

            <div class="form-group">
              <label for="edit-agent-prompt">System Prompt</label>
              <textarea id="edit-agent-prompt" rows="6" placeholder="You are a helpful assistant..."></textarea>
            </div>

            <div class="form-group">
              <label for="edit-first-message">First Message</label>
              <input type="text" id="edit-first-message" placeholder="Hello! How can I help you today?" />
            </div>

            <div class="form-group">
              <label for="edit-voice-select">Voice</label>
              <div class="voice-select-wrapper">
                <select id="edit-voice-select">
                  <option value="">Loading voices...</option>
                </select>
                <button type="button" class="btn-preview" id="edit-preview-voice-btn" title="Preview voice">
                  ‚ñ∂
                </button>
                <button type="button" class="btn-browse" id="edit-browse-voices-btn" title="Browse Voice Library">
                  üîç
                </button>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="edit-language-select">Language</label>
                <select id="edit-language-select">
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="pl">Polish</option>
                  <option value="hi">Hindi</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="zh">Chinese</option>
                </select>
              </div>
            </div>

            <div class="modal-actions">
              <button type="button" class="btn-secondary" onclick="window.closeEditModal()">Cancel</button>
              <button type="button" class="btn-danger" id="delete-agent-btn">Delete Agent</button>
              <button type="submit" id="save-agent-btn">Save Changes</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Conversation Section -->
      <section id="conversation-section" class="conversation-section hidden">
        <h2>Conversation</h2>
        <p id="active-agent">Agent: <span>None selected</span></p>
        
        <div class="controls">
          <div class="buttons">
            <button id="start" disabled>Start Conversation</button>
            <button id="stop" disabled>Stop Conversation</button>
          </div>
          <p class="status" id="status">Status: idle</p>
        </div>

        <div>
          <h3>Events</h3>
        <div id="log" class="log"></div>
        </div>
      </section>
    </main>
    <script src="app.js" type="module"></script>
  </body>
</html>
